# N1 å’Œ CL1 å‘¨äº”è¿è¡Œæƒ…å†µæ£€æŸ¥æŠ¥å‘Š

**æ£€æŸ¥æ—¶é—´**: 2025-12-15 11:45:17 PST

## ğŸ“‹ æ£€æŸ¥ç»“æœæ€»ç»“

### âœ… é…ç½®éªŒè¯é€šè¿‡

#### 1. å‘¨æœ«è¯†åˆ«é€»è¾‘
- **å‘¨äº”è¯†åˆ«**: âœ… æ­£ç¡®è¯†åˆ«ä¸ºå·¥ä½œæ—¥
- **weekday å€¼**: 4 (0=å‘¨ä¸€, 4=å‘¨äº”, 5=å‘¨å…­, 6=å‘¨æ—¥)
- **is_weekend() å‡½æ•°**: `date.weekday() >= 5` - åªè·³è¿‡å‘¨å…­å’Œå‘¨æ—¥
- **ç»“è®º**: å‘¨äº”ä¸ä¼šè¢«è·³è¿‡ï¼Œåº”è¯¥æ­£å¸¸è¿è¡Œ

#### 2. GitHub Actions Cron é…ç½®

**CL1 (Cancellations)**:
- é…ç½®æ–‡ä»¶: `.github/workflows/daily-cancellation.yml`
- Cron è¡¨è¾¾å¼: 
  - `0 18 * * *` (UTC 18:00 = 11:00 AM PDT)
  - `0 19 * * *` (UTC 19:00 = 11:00 AM PST)
- **çŠ¶æ€**: âœ… é…ç½®ä¸ºæ¯å¤©è¿è¡Œï¼ˆåŒ…æ‹¬å‘¨äº”ï¼‰

**N1 (Renewals)**:
- é…ç½®æ–‡ä»¶: `.github/workflows/daily-renewal.yml`
- Cron è¡¨è¾¾å¼:
  - `0 23 * * *` (UTC 23:00 = 4:00 PM PDT)
  - `0 0 * * *` (UTC 00:00 = 4:00 PM PST)
- **çŠ¶æ€**: âœ… é…ç½®ä¸ºæ¯å¤©è¿è¡Œï¼ˆåŒ…æ‹¬å‘¨äº”ï¼‰

#### 3. main.py è¿è¡Œé€»è¾‘

- **å‘¨æœ«æ£€æŸ¥ä½ç½®**: ç¬¬ 105 è¡Œ
- **æ£€æŸ¥é€»è¾‘**: 
  ```python
  if is_weekend(today_date):
      logger.info(f"Skipping: Today is {today_date.strftime('%A')} (weekend)")
      return 0
  ```
- **CL1 è¿è¡Œæ—¶é—´**: 11:00 AM Pacific
- **N1 è¿è¡Œæ—¶é—´**: 4:00 PM Pacific
- **çŠ¶æ€**: âœ… é€»è¾‘æ­£ç¡®ï¼Œå‘¨äº”ä¸ä¼šè¢«è·³è¿‡

## ğŸ“… è¿è¡Œæ—¶é—´è¡¨

| é¡¹ç›® | è¿è¡Œæ—¶é—´ (Pacific) | å·¥ä½œæ—¥ | å‘¨æœ« |
|------|-------------------|--------|------|
| CL1 | 11:00 AM | âœ… è¿è¡Œ | âŒ è·³è¿‡ |
| N1 | 4:00 PM | âœ… è¿è¡Œ | âŒ è·³è¿‡ |

**å‘¨äº”çŠ¶æ€**: âœ… å·¥ä½œæ—¥ï¼Œä¸¤ä¸ªé¡¹ç›®éƒ½ä¼šè¿è¡Œ

## ğŸ“Š æ—¥å¿—æ–‡ä»¶æ£€æŸ¥

**å½“å‰æ—¥å¿—æ–‡ä»¶**:
- `logs/cron/cancellations_2025-11-12.log` (2025-11-12 æ˜¯å‘¨äºŒ)

**å‘¨äº”æ—¥å¿—æ–‡ä»¶**: âš ï¸ æœªæ‰¾åˆ°
- å¯èƒ½åŸå› :
  1. é¡¹ç›®åˆšéƒ¨ç½²ï¼Œè¿˜æ²¡æœ‰è¿è¡Œåˆ°å‘¨äº”
  2. GitHub Actions è¿˜æœªæ‰§è¡Œè¿‡å‘¨äº”çš„è¿è¡Œ
  3. æ—¥å¿—æ–‡ä»¶å‘½åé—®é¢˜ï¼ˆå½“å‰æ—¥å¿—æ–‡ä»¶åå›ºå®šä¸º `cancellations_YYYY-MM-DD.log`ï¼‰

## ğŸ¯ ç»“è®º

### âœ… é…ç½®æ­£ç¡®
1. **å‘¨äº”è¯†åˆ«**: ä»£ç æ­£ç¡®è¯†åˆ«å‘¨äº”ä¸ºå·¥ä½œæ—¥
2. **Cron é…ç½®**: GitHub Actions é…ç½®ä¸ºæ¯å¤©è¿è¡Œï¼ŒåŒ…æ‹¬å‘¨äº”
3. **è·³è¿‡é€»è¾‘**: å‘¨æœ«è·³è¿‡é€»è¾‘ä¸ä¼šå½±å“å‘¨äº”

### ğŸ“ é¢„æœŸè¡Œä¸º
- **CL1**: æ¯ä¸ªå‘¨äº” 11:00 AM Pacific åº”è¯¥è‡ªåŠ¨è¿è¡Œ
- **N1**: æ¯ä¸ªå‘¨äº” 4:00 PM Pacific åº”è¯¥è‡ªåŠ¨è¿è¡Œ

### âš ï¸ éªŒè¯å»ºè®®
1. **æŸ¥çœ‹ GitHub Actions è¿è¡Œå†å²**:
   - è®¿é—® GitHub ä»“åº“çš„ Actions æ ‡ç­¾
   - æŸ¥çœ‹ "Daily Cancellation Workflow" å’Œ "Daily Renewal Workflow"
   - æ£€æŸ¥æœ€è¿‘çš„å‘¨äº”æ˜¯å¦æœ‰è¿è¡Œè®°å½•

2. **æ£€æŸ¥æ—¥å¿—æ–‡ä»¶**:
   - ç­‰å¾…ä¸‹ä¸€ä¸ªå‘¨äº”è¿è¡Œå
   - æŸ¥çœ‹ `logs/cron/cancellations_YYYY-MM-DD.log` æ–‡ä»¶
   - ç¡®è®¤æ˜¯å¦æœ‰è¿è¡Œè®°å½•

3. **æ‰‹åŠ¨æµ‹è¯•** (å¯é€‰):
   ```bash
   # è®¾ç½®ç¯å¢ƒå˜é‡æ¨¡æ‹Ÿå‘¨äº”è¿è¡Œ
   $env:WORKFLOW_TYPE="cancellations"
   python main.py
   ```

## ğŸ” ä»£ç éªŒè¯

### is_weekend() å‡½æ•°
```python
def is_weekend(date):
    """Check if a date falls on weekend"""
    return date.weekday() >= 5  # 5=Saturday, 6=Sunday
```
- âœ… å‘¨äº” weekday = 4ï¼Œä¸ä¼šè¢«è¯†åˆ«ä¸ºå‘¨æœ«

### main.py å‘¨æœ«æ£€æŸ¥
```python
# Check if today is weekend (skip weekends, no calls on weekends)
today_date = now_pacific.date()
if is_weekend(today_date):
    logger.info(f"Skipping: Today is {today_date.strftime('%A')} (weekend)")
    return 0
```
- âœ… å‘¨äº”ä¸ä¼šè¢«è·³è¿‡

## ğŸ“Œ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç­‰å¾…ä¸‹ä¸€ä¸ªå‘¨äº”** (2025-12-19) éªŒè¯å®é™…è¿è¡Œ
2. **ç›‘æ§ GitHub Actions** ç¡®è®¤è‡ªåŠ¨æ‰§è¡Œ
3. **æ£€æŸ¥æ—¥å¿—æ–‡ä»¶** ç¡®è®¤è¿è¡Œè®°å½•
4. **å¦‚æœ‰é—®é¢˜**ï¼ŒæŸ¥çœ‹ GitHub Actions è¿è¡Œæ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-12-15 11:45:17 PST  
**æ£€æŸ¥è„šæœ¬**: `scripts/check_friday_runs.py`

